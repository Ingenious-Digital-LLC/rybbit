"use strict";(()=>{(function(){let e="[rybbit-ad]",n=document.currentScript;if(!n){console.warn(e,"Could not find script tag");return}let r=n.getAttribute("src")||"",a=r.split("/ad.js")[0].replace("/api",""),o=n.getAttribute("data-site-id")||"";if(console.log(e,"Initialized",{siteId:o,analyticsHost:a,src:r}),!o){console.warn(e,"No data-site-id attribute found on script tag");return}document.addEventListener("click",function(u){let l=u.target.closest("a");if(!l)return;let d=l.querySelector("img");if(!d){console.debug(e,"Click on <a> but no <img> found inside, skipping");return}let s=d.src;if(!s){console.debug(e,"Image has no src, skipping");return}let g="";try{g=new URL(s).hostname}catch{}let c={type:"ad_click",site_id:o,pathname:s,hostname:g,screenWidth:window.screen.width,screenHeight:window.screen.height,language:navigator.language,page_title:document.title,referrer:document.referrer},i=a+"/api/track";if(console.log(e,"Sending ad_click",{url:i,payload:c}),navigator.sendBeacon){let t=navigator.sendBeacon(i,JSON.stringify(c));console.log(e,"sendBeacon result:",t)}else fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c),keepalive:!0}).then(t=>console.log(e,"fetch response:",t.status)).catch(t=>console.error(e,"fetch error:",t))})})();})();
